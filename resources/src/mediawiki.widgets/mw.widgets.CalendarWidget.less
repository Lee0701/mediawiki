/*!
 * MediaWiki Widgets â€“ CalendarWidget styles.
 *
 * @copyright 2011-2015 MediaWiki Widgets Team and others; see AUTHORS.txt
 * @license The MIT License (MIT); see LICENSE.txt
 */

/* stylelint-disable no-duplicate-selectors */
@import 'mediawiki.mixins.less';

@calendarinline-size: 21em;
@calendarblock-size: 14em;

.mw-widget-calendarWidget {
	inline-size: @calendarWidth;
}

.mw-widget-calendarWidget-header {
	position: relative;
	line-height: 2.5;

	// Overwrite OOUI's `.oo-ui-buttonElement-frameless.oo-ui-iconElement:first-child`
	.oo-ui-buttonWidget.oo-ui-iconElement {
		margin-inline-start: 0;
		margin-inline-end: 0;
	}

	.mw-widget-calendarWidget-labelButton {
		margin-block: 0;
		margin-inline: auto;
		display: block;
		inline-size: @calendarWidth - 2 * 3em;

		.oo-ui-buttonElement-button {
			inline-size: @calendarWidth - 2 * 3em;
			text-align: center;
		}
	}
}

.mw-widget-calendarWidget-upButton {
	position: absolute;
	inset-block-start: 0;
	inset-inline-end: 3em;
	pointer-events: none;
}

.mw-widget-calendarWidget-prevButton {
	float: left;
}

.mw-widget-calendarWidget-nextButton {
	float: right;
}

.mw-widget-calendarWidget-body-outer-wrapper {
	clear: both;
	position: relative;
	overflow: hidden;
	// Fit 7 days, 3em each
	inline-size: @calendarWidth;
	// Fit 6 weeks + heading line, 2em each
	block-size: @calendarHeight;
}

.mw-widget-calendarWidget-body-wrapper {
	.mw-widget-calendarWidget-body {
		display: inline-block;
		display: inline-grid;
		// Fit 7 days, 3em each
		inline-size: @calendarWidth;
		// Fit 6 weeks + heading line, 2em each
		block-size: @calendarHeight;
	}

	.mw-widget-calendarWidget-body:not( .mw-widget-calendarWidget-old-body ):first-child {
		margin-block-start: -@calendarHeight;
		margin-inline-start: -@calendarWidth;
	}

	.mw-widget-calendarWidget-body:not( .mw-widget-calendarWidget-old-body ):last-child {
		margin-block-start: 0;
		margin-inline-start: 0;
	}
}

.mw-widget-calendarWidget-body-wrapper-fade-previous {
	inline-size: @calendarWidth * 2;
	block-size: @calendarHeight;

	.mw-widget-calendarWidget-body:first-child {
		margin-block-start: 0 !important; /* stylelint-disable-line declaration-no-important */
		margin-inline-start: 0 !important; /* stylelint-disable-line declaration-no-important */
		transition: margin-left 500ms;
	}
}

.mw-widget-calendarWidget-body-wrapper-fade-next {
	inline-size: @calendarWidth * 2;
	block-size: @calendarHeight;

	.mw-widget-calendarWidget-body:first-child {
		margin-inline-start: -@calendarWidth !important; /* stylelint-disable-line declaration-no-important */
		margin-block-start: 0 !important; /* stylelint-disable-line declaration-no-important */
		transition: margin-left 500ms;
	}
}

.mw-widget-calendarWidget-body-wrapper-fade-up {
	inline-size: @calendarWidth;
	block-size: @calendarHeight * 2;

	.mw-widget-calendarWidget-body {
		display: block;
		display: grid;
	}

	.mw-widget-calendarWidget-body:first-child {
		margin-inline-start: 0 !important; /* stylelint-disable-line declaration-no-important */
		margin-block-start: 0 !important; /* stylelint-disable-line declaration-no-important */
		transition: margin-top 500ms;
	}
}

.mw-widget-calendarWidget-body-wrapper-fade-down {
	inline-size: @calendarWidth;
	block-size: @calendarHeight * 2;

	.mw-widget-calendarWidget-body {
		display: block;
		display: grid;
	}

	.mw-widget-calendarWidget-body:first-child {
		margin-inline-start: 0 !important; /* stylelint-disable-line declaration-no-important */
		margin-block-start: -@calendarHeight !important; /* stylelint-disable-line declaration-no-important */
		transition: margin-top 500ms;
	}
}

// Support: Browsers that render CSS Grid. All others ignore unknown `grid-*` properties.
// This avoids any calculation issues pushing items to next line.
.mw-widget-calendarWidget-body-month {
	grid-template-columns: auto auto auto auto auto auto auto;
}

.mw-widget-calendarWidget-body-year {
	grid-template-columns: auto auto;
}

.mw-widget-calendarWidget-body-duodecade {
	grid-template-columns: auto auto auto auto auto;
}

.mw-widget-calendarWidget-day,
.mw-widget-calendarWidget-day-heading,
.mw-widget-calendarWidget-month,
.mw-widget-calendarWidget-year {
	display: inline-block;
	vertical-align: middle;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	text-align: center;
}

.mw-widget-calendarWidget-day,
.mw-widget-calendarWidget-day-heading {
	// 7x7 grid
	inline-size: @calendarWidth / 7;
	line-height: @calendarHeight / 7;

	// Don't overlap the hacked-up fake box-shadow border we get when focussed
	&:nth-child( 7n ) {
		inline-size: @calendarWidth / 7 - 0.2em;
		margin-inline-end: 0.2em;
	}

	&:nth-child( 7n+1 ) {
		inline-size: @calendarWidth / 7 - 0.2em;
		margin-inline-start: 0.2em;
	}

	&:nth-child( 42 ) ~ & {
		line-height: @calendarHeight / 7 - 0.2em;
		margin-block-end: 0.2em;
	}
}

.mw-widget-calendarWidget-month {
	// 2x6 grid
	inline-size: @calendarWidth / 2;
	line-height: @calendarHeight / 6;

	// Don't overlap the hacked-up fake box-shadow border we get when focussed
	&:nth-child( 2n ) {
		inline-size: @calendarWidth / 2 - 0.2em;
		margin-inline-end: 0.2em;
	}

	&:nth-child( 2n+1 ) {
		inline-size: @calendarWidth / 2 - 0.2em;
		margin-inline-start: 0.2em;
	}

	&:nth-child( 10 ) ~ & {
		line-height: @calendarHeight / 6 - 0.2em;
		margin-block-end: 0.2em;
	}
}

.mw-widget-calendarWidget-year {
	// 5x4 grid
	inline-size: @calendarWidth / 5;
	line-height: @calendarHeight / 4;

	// Don't overlap the hacked-up fake box-shadow border we get when focussed
	&:nth-child( 5n ) {
		inline-size: @calendarWidth / 5 - 0.2em;
		margin-inline-end: 0.2em;
	}

	&:nth-child( 5n+1 ) {
		inline-size: @calendarWidth / 5 - 0.2em;
		margin-inline-start: 0.2em;
	}

	&:nth-child( 15 ) ~ & {
		line-height: @calendarHeight / 4 - 0.2em;
		margin-block-end: 0.2em;
	}
}

.mw-widget-calendarWidget-item {
	cursor: pointer;
}

/* Theme-specific */
.mw-widget-calendarWidget {
	box-sizing: border-box;
	border: 1px solid #a2a9b1;
	transition: border-color 100ms, box-shadow 100ms;

	&:focus {
		border-color: #36c;
		box-shadow: inset 0 0 0 1px #36c;
		outline: 0;
	}

	&-day {
		color: #202122;
		border-radius: 2px;
	}

	&-day-heading {
		color: #54595d;
		font-weight: bold;
	}

	&-day-additional {
		color: #a2a9b1;

		&:hover {
			color: #202122;
		}
	}

	&-day-today {
		box-shadow: inset 0 0 0 1px #36c;
	}

	&-item {
		transition: background-color 250ms, color 250ms;

		&:hover {
			background-color: #36c;
			color: #fff;
		}

		&-selected {
			background-color: #2a4b8d;
			color: #fff;
		}
	}
}
